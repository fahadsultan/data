

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.1. Probability &#8212; CSC-272 Data Mining</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHTXXD4572"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHTXXD4572');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2_maths/11_probability';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2. Statistics" href="12_stats.html" />
    <link rel="prev" title="4. Prob, Stats and Logs" href="10_prob_stats_log.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    CSC-272 Data Mining (Fall 2023)
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../calendar.html">Calendar</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../syllabus/index.html">Syllabus</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/grading.html">Grading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/textbook.html">Textbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/mental_health.html">Mental Health</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/academic_success.html">Center for Academic Success</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/accomodations.html">Accomodations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/integrity.html">Academic Integrity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../syllabus/title_9.html">Nondiscrimination Policy and Sexual Misconduct</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../project/project.html">Course Project</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../project/data.html">Data sets and Project ideas</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Programming for Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_programming/10_dataops.html">1. Vectorized Operations on Data</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/pandas1.html">1.1. Pandas I: Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/pandas2.html">1.2. Pandas II: Selection, Filtering and Dropping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/pandas3.html">1.3. Pandas III: Aggregation, Merging and Concatenation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_programming/40_modalities.html">2. Encoding and Representation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/41_types.html">2.1. Feature Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/42_formats.html">2.2. Common Data Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/43_modalities.html">2.3. Modalities of Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_programming/20_visualization.html">3. Visualizing Data</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/21_univariate.html">3.1. Univariate Visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/22_multivariate.html">3.2. Multivariate Visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_programming/23_dosdonts.html">3.3. Dos and Donts of Visualization</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathematics for Data Science</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="10_prob_stats_log.html">4. Prob, Stats and Logs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.1. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_stats.html">4.2. Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_log.html">4.3. Logarithms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="40_linearalgebra.html">5. Linear Algebra and Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="41_vectors.html">5.1. Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="42_matrices.html">5.2. Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="43_applications.html">5.3. Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="50_calculus.html">6. Calculus</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Problems in Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_problems_in/40_supervised.html">7. Supervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_problems_in/41_classification.html">7.6. Classification</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_problems_in/20_unsupervised.html">8. Unsupervised Learning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_problems_in/21_clustering.html">8.1. Clustering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_problems_in/30_reinforcement.html">9. Reinforcement Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Models in Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../4_models/graphical.html">10. Graphical Models</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../4_models/41_naivebayes.html">10.1. Naive Bayes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_problems_in/22_kmeans.html">11. Mixture Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_models/generalized.html">12. Generalized Linear Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Algorithms in Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5_algos/em.html">13. Expectation Maximization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_algos/gradient_descent.html">14. Gradient Descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5_algos/backprop.html">15. Backpropogation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Problems with Data Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6_problems_with/10_representation.html">16. Representation Matters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_problems_with/40_feedback.html">17. Positive Feedback Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_problems_with/20_boundaries.html">18. Decision Boundaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6_problems_with/30_incentives.html">19. Majority Rule</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/fahadsultan/datascience_ml/blob/main/2_maths/11_probability.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/2_maths/11_probability.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Probability</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-variable">4.1.1. Random Variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-outcome-omega-and-sample-space-omega">4.1.2. Experiment, Outcome <span class="math notranslate nohighlight">\(\omega\)</span> and Sample Space <span class="math notranslate nohighlight">\(\Omega\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-model-p-x">4.1.3. Probability Model <span class="math notranslate nohighlight">\(P(X)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-an-event-p-phi">4.1.4. Probability of an Event <span class="math notranslate nohighlight">\(P(\phi)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-probability-p-a-b">4.1.5. Joint Probability <span class="math notranslate nohighlight">\(P(A, B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#marginal-probability-p-a">4.1.6. Marginal Probability <span class="math notranslate nohighlight">\(P(A)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-random-variables">4.1.7. Independent Random Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-probability-p-a-b">4.1.8. Conditional Probability <span class="math notranslate nohighlight">\(P(A | B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#product-rule-p-a-b">4.1.9. Product Rule <span class="math notranslate nohighlight">\(P(A, B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chain-rule-p-a-b-c">4.1.10. Chain Rule <span class="math notranslate nohighlight">\(P(A, B, C)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusion-exclusion-principle-p-a-vee-b">4.1.11. Inclusion-Exclusion Principle <span class="math notranslate nohighlight">\(P(A \vee B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-theorem-p-a-b">4.1.12. Bayes Theorem <span class="math notranslate nohighlight">\(P(A|B)\)</span></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="probability">
<h1><span class="section-number">4.1. </span>Probability<a class="headerlink" href="#probability" title="Permalink to this headline">#</a></h1>
<p>Probability allows us to talk about uncertainty, in certain terms. Once, we are able to quantify uncertainties, we can deterministically make deductions about the future. The language of statistics also allows us to talk about uncertainty in uncertain but tractable terms that we can reason about.</p>
<section id="random-variable">
<h2><span class="section-number">4.1.1. </span>Random Variable<a class="headerlink" href="#random-variable" title="Permalink to this headline">#</a></h2>
<p>A <strong>random variable</strong> is a mathematical formalization of an abstract quantity that has some degree of uncertainty associated with the values it may take on.
The set of all possible values that a random variable can take on is called its <strong>range</strong>.</p>
<p>A random variable is very much similar to a variable in computer programming. <strong>In the context of <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, a random variable is a column or feature in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</strong></p>
<p>Just as numerical features in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be either discrete or continuous, random variables can also be either discrete or continuous. The two types require different mathematical formalizations as we will see later.</p>
<p>Random variables are usually denoted by capital letters, such as <span class="math notranslate nohighlight">\(X\)</span> or <span class="math notranslate nohighlight">\(Y\)</span>. The values that a random variable can take on are denoted by lower case letters, such as <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>It is important to note that in the real world, it is <em>often impossible to obtain the range</em> of a random variable. Since most real-world datasets are <strong>samples</strong>, <strong><code class="docutils literal notranslate"><span class="pre">df['X'].unique()</span></code> does not necessarily give us the range of <span class="math notranslate nohighlight">\(X\)</span></strong>.</p>
<p>It is also important to remember that <strong><span class="math notranslate nohighlight">\(x\)</span> is a single value</strong> but <strong><span class="math notranslate nohighlight">\(X\)</span> is a collection of values</strong> (i.e. <code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>).</p>
<p>In the example below, <span class="math notranslate nohighlight">\(C\)</span> (coin) and <span class="math notranslate nohighlight">\(D\)</span> (dice) are two random variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/experiment.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>T</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>T</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>T</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The ranges of <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span> are <span class="math notranslate nohighlight">\(\{H, T\}\)</span> and <span class="math notranslate nohighlight">\(\{1, 2, 3, 4, 5, 6\}\)</span> respectively. It is worth repeating for emphasis that the ranges of the two variables is independent of observed data, since the observed data is a limited sample.</p>
</section>
<section id="experiment-outcome-omega-and-sample-space-omega">
<h2><span class="section-number">4.1.2. </span>Experiment, Outcome <span class="math notranslate nohighlight">\(\omega\)</span> and Sample Space <span class="math notranslate nohighlight">\(\Omega\)</span><a class="headerlink" href="#experiment-outcome-omega-and-sample-space-omega" title="Permalink to this headline">#</a></h2>
<p>An <strong>outcome</strong>, denoted by <span class="math notranslate nohighlight">\(\omega\)</span>, is the set of values that one or more random variables take on as a result of an <strong>experiment</strong>.</p>
<p>An <strong>experiment</strong> is a process that yields outcomes out of set of all possible outcomes.</p>
<p>The <strong>sample space</strong>, denoted by <span class="math notranslate nohighlight">\(\Omega\)</span>, is the set of all possible outcomes.</p>
<p>The important operative word here is <em>“possible”</em>. <u>The sample space is <em>not</em> the set of all <em>observed</em> outcomes</u>, the set of all possible outcomes.</p>
<p>If an experiment involves two random variables say <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> which <em>can</em> take on <span class="math notranslate nohighlight">\(n\)</span> possible values (i.e. <span class="math notranslate nohighlight">\(~\text{range}_X = \{x_1, x_2, \ldots, x_n\})\)</span> and <span class="math notranslate nohighlight">\(m\)</span> possible values (i.e. <span class="math notranslate nohighlight">\(~\text{range}_Y = \{y_1, y_2, \ldots, y_m\}\)</span>) respectively, then the sample space <span class="math notranslate nohighlight">\(\Omega\)</span> is the set of all possible combinations of <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_j\)</span> and is of size <span class="math notranslate nohighlight">\(n \times m\)</span>.</p>
<br/>
<center>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p><strong><span class="math notranslate nohighlight">\(\omega_i\)</span></strong></p></th>
<th class="text-center head"><p><strong><span class="math notranslate nohighlight">\(X\)</span></strong></p></th>
<th class="text-center head"><p><strong><span class="math notranslate nohighlight">\(Y\)</span></strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_2\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>:</p></td>
<td class="text-center"><p>:</p></td>
<td class="text-center"><p>:</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_{m}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_m\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_{m+1}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_{m+2}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_2\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>:</p></td>
<td class="text-center"><p>:</p></td>
<td class="text-center"><p>:</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_{n \times m}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x_n\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_m\)</span></p></td>
</tr>
</tbody>
</table>
</center>
<br/>
<p>In other words, the sample space is the <strong>cross product of the ranges of all random variables</strong> involved in the experiment.</p>
<p>In our example, the experiment is the act of tossing a coin and rolling a dice.</p>
<p>Each row in the data is an outcome <span class="math notranslate nohighlight">\(w_i\)</span> from the set of all possible outcomes <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p><span class="math notranslate nohighlight">\(C\)</span> variable can take on two (<span class="math notranslate nohighlight">\(n=2\)</span>) values: <span class="math notranslate nohighlight">\(\{H, T\}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> variable can take on six <span class="math notranslate nohighlight">\(m=6\)</span> value: <span class="math notranslate nohighlight">\(\{1, 2, 3, 4, 5, 6\}\)</span>. This means that the sample space <span class="math notranslate nohighlight">\(\Omega\)</span> is of size <span class="math notranslate nohighlight">\(n \times m = 2 \times 6 = 12\)</span>.</p>
<p>However, the observed outcomes are only 11, as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This means that the sample space <span class="math notranslate nohighlight">\(\Omega\)</span> is not the set of all observed outcomes. This is despite the fact that many observed outcomes are observed more than once. The missing outcome, that is never observed, is <span class="math notranslate nohighlight">\(w_{12} = (T, 6)\)</span>.</p>
</section>
<section id="probability-model-p-x">
<h2><span class="section-number">4.1.3. </span>Probability Model <span class="math notranslate nohighlight">\(P(X)\)</span><a class="headerlink" href="#probability-model-p-x" title="Permalink to this headline">#</a></h2>
<p>Probability model is a function that assigns a probability score <span class="math notranslate nohighlight">\(P(\omega_i)\)</span> to each possible outcome <span class="math notranslate nohighlight">\(\omega_i\)</span> for every <span class="math notranslate nohighlight">\(\omega_i \in \Omega\)</span> such that</p>
<!-- $ 0 \lt P(\omega_i) \lt 1 $ and $\sum_{\omega \in \Omega} P(\omega_i) = 1$. -->
<!-- such that  -->
<div class="math notranslate nohighlight">
\[ 0 \lt P(\omega_i) \lt 1 ~~~\text{and}~~~ \sum_{\omega \in \Omega} P(\omega_i) = 1\]</div>
<p>For example, if we have a random variable <span class="math notranslate nohighlight">\(D\)</span> for rolling a die, the probability model assigns a probability to each number that we can roll. The probability model is usually denoted by <span class="math notranslate nohighlight">\(P(\omega_i)\)</span> or <span class="math notranslate nohighlight">\(P(D=d)\)</span></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p><span class="math notranslate nohighlight">\(\omega\)</span></p></th>
<th class="text-center head"><p><span class="math notranslate nohighlight">\(D\)</span></p></th>
<th class="text-center head"><p><span class="math notranslate nohighlight">\(P(D=d)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=1)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=2)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_3\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=3)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_4\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(4\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=4)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_5\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=5)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_6\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(P(D=6)\)</span></p></td>
</tr>
</tbody>
</table>
<p>such that <span class="math notranslate nohighlight">\(0 \leq P(D=d) \leq 1\)</span> and and <span class="math notranslate nohighlight">\(\sum_{d \in D} P(d=D) = 1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fair_die</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/fair_die.csv&#39;</span><span class="p">)</span>
<span class="n">fair_die</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>P(D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.166667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The code cell above shows the probability model for the random variable <span class="math notranslate nohighlight">\(D\)</span> for a fair die in our examples, where each number has a probability of <span class="math notranslate nohighlight">\(\frac{1}{6}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fair_die</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P(D)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Probability distribution of rolling a fair die&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4f5d3ba2ef2f279705b8ddb94abfc622ae172c5bb7d76e4c0b06cf9cdd35597e.png" src="../_images/4f5d3ba2ef2f279705b8ddb94abfc622ae172c5bb7d76e4c0b06cf9cdd35597e.png" />
</div>
</div>
<div class="admonition-a-word-of-caution-on-u-mathematical-notation-u-and-u-dimensionality-u admonition">
<p class="admonition-title">A word of caution on <u>mathematical notation</u> and <u>dimensionality</u>: </p>
<p>Uppercase letters (<span class="math notranslate nohighlight">\(X, Y ...\)</span>) often refer to a random variable. Lowercase letters (<span class="math notranslate nohighlight">\(x, y ...\)</span>) often refer to a particular outcome of a random variable.</p>
<p>The following refer to a probability <u>value</u> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> etc.):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(X = x)\)</span></p>
<ul>
<li><p>also written in shorthand as <span class="math notranslate nohighlight">\(P(x)\)</span></p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(P(X = x ∧ Y = y)\)</span></p>
<ul>
<li><p>also written in shorthand as <span class="math notranslate nohighlight">\(P(x, y)\)</span></p></li>
</ul>
</li>
</ul>
<p>The following refer to <u>a collection of values</u> (<code class="docutils literal notranslate"><span class="pre">pd.Series</span></code>, <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> etc.):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(X)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(X ∧ Y)\)</span></p>
<ul>
<li><p>also written as P(X, Y)</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(P(X = x, Y)\)</span></p></li>
</ul>
</div>
</section>
<section id="probability-of-an-event-p-phi">
<h2><span class="section-number">4.1.4. </span>Probability of an Event <span class="math notranslate nohighlight">\(P(\phi)\)</span><a class="headerlink" href="#probability-of-an-event-p-phi" title="Permalink to this headline">#</a></h2>
<p>An event <span class="math notranslate nohighlight">\(\phi\)</span> is a set of possible worlds <span class="math notranslate nohighlight">\(\{\omega_i, \omega_j, ... \omega_n\}\)</span>. In other words, an event <span class="math notranslate nohighlight">\(\phi\)</span> is a subset of <span class="math notranslate nohighlight">\(\Omega\)</span> i.e. <span class="math notranslate nohighlight">\(\phi \subset \Omega\)</span></p>
<p>If we continue with the example of rolling a die, we can define an event <span class="math notranslate nohighlight">\(\phi\)</span> as the set of all possible worlds where the die rolls an even number. From the table above, we can see that there are three possible worlds where the die rolls an even number.</p>
<p>Therefore, the event <span class="math notranslate nohighlight">\(\phi\)</span> is the set <span class="math notranslate nohighlight">\(\{\omega_2, \omega_4, \omega_6\}\)</span> or <span class="math notranslate nohighlight">\(\{D=2, D=4, D=6\}\)</span>.</p>
<!-- An example of an event is at least one Heads  $ \phi = \{\omega_1 , \omega_2 , \omega_3\}$ -->
<p><span class="math notranslate nohighlight">\(P (\phi) = \sum_{\omega \in \phi} P(\omega)\)</span> is the sum of probabilities of the set of possible worlds defining <span class="math notranslate nohighlight">\(\phi\)</span></p>
<p><span class="math notranslate nohighlight">\(P (\phi_1) = P(\text{Die rolls an even number}) = P(\omega_2) +P(\omega_4) + P(\omega_6) = 0.167 + 0.167 + 0.167  \approx 0.5 \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">event_condition</span> <span class="o">=</span> <span class="n">fair_die</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">event</span> <span class="o">=</span> <span class="n">fair_die</span><span class="p">[</span><span class="n">event_condition</span><span class="p">]</span>

<span class="n">P_event</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;P(D)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">round</span><span class="p">(</span><span class="n">P_event</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
</section>
<section id="joint-probability-p-a-b">
<h2><span class="section-number">4.1.5. </span>Joint Probability <span class="math notranslate nohighlight">\(P(A, B)\)</span><a class="headerlink" href="#joint-probability-p-a-b" title="Permalink to this headline">#</a></h2>
<p>Joint probability is the probability of two events occurring together.The joint probability is usually denoted by <span class="math notranslate nohighlight">\(P(A, B)\)</span>, which is shorthand for <span class="math notranslate nohighlight">\(P(A \wedge B)\)</span> read as <em>Probability of <span class="math notranslate nohighlight">\(A\)</span> AND <span class="math notranslate nohighlight">\(B\)</span>.</em></p>
<p>Note that <span class="math notranslate nohighlight">\(P(A, B) = P(B, A)\)</span> since <span class="math notranslate nohighlight">\(A \wedge B = B \wedge A\)</span>.</p>
<p>For example, if we are rolling two dice, the joint probability is the probability of rolling a 1 on the first die and a 2 on the second die.</p>
<p>In Data Science, we rarely know the true joint probability. Instead, we estimate the joint probability from data. We will talk more about this when we talk about Statistics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/experiment_probs.csv&#39;</span><span class="p">)</span>
<span class="n">joint_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span><span class="p">[</span><span class="s1">&#39;P(C, D)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Note that sum of joint probabilities is 1 i.e. <span class="math notranslate nohighlight">\(\sum P(C, D) = 1\)</span> at the end of the day, since the sum of all probabilities is 1.</p>
<p>The following three are all true at the same time:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\sum_{C, D} P(C, D) = 1\)</span> where <span class="math notranslate nohighlight">\(P(C, D)\)</span> is a probability table with 12 rows and 3 columns: <span class="math notranslate nohighlight">\(C, D, P(C, D)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sum_{C} P(C) = 1\)</span> where <span class="math notranslate nohighlight">\(P(C)\)</span> is a probability table with 2 rows (<span class="math notranslate nohighlight">\({H, T}\)</span>) and 2 columns: <span class="math notranslate nohighlight">\(C, P(C)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sum_{D} P(D) = 1\)</span> where <span class="math notranslate nohighlight">\(P(D)\)</span> is a probability table with 6 rows (<span class="math notranslate nohighlight">\({1, 2, 3, 4, 5, 6}\)</span>) and 2 columns: <span class="math notranslate nohighlight">\(D, P(D)\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span><span class="p">[</span><span class="s2">&quot;CD_vals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">joint_probs</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;C=</span><span class="si">%s</span><span class="s2"> and D=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
      <th>CD_vals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
      <td>C=H and D=1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
      <td>C=H and D=2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
      <td>C=H and D=3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
      <td>C=H and D=4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
      <td>C=H and D=5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
      <td>C=H and D=6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
      <td>C=T and D=1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
      <td>C=T and D=2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
      <td>C=T and D=3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
      <td>C=T and D=4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
      <td>C=T and D=5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
      <td>C=T and D=6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">joint_probs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;CD_vals&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P(C, D)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Joint probability distribution of C and D</span><span class="se">\n</span><span class="s2"> Note that the joint probabilities sum to 1&quot;</span><span class="p">,</span> \
        <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;C and D values&quot;</span><span class="p">,</span> \
        <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;P(C, D)&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c484ac4cf55271f8f6bfdbc2de21adb4a6991fe3e4ffcfd93935ed57d1ff0ef0.png" src="../_images/c484ac4cf55271f8f6bfdbc2de21adb4a6991fe3e4ffcfd93935ed57d1ff0ef0.png" />
</div>
</div>
</section>
<section id="marginal-probability-p-a">
<h2><span class="section-number">4.1.6. </span>Marginal Probability <span class="math notranslate nohighlight">\(P(A)\)</span><a class="headerlink" href="#marginal-probability-p-a" title="Permalink to this headline">#</a></h2>
<p>Because most data sets are multi-dimensional i.e. involving multiple random variables, we can sometimes find ourselves in a situation where we want to know the joint probability <span class="math notranslate nohighlight">\(P(A, B)\)</span> of two random variables <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> but we don’t know <span class="math notranslate nohighlight">\(P(A)\)</span> or <span class="math notranslate nohighlight">\(P(B)\)</span>. In such cases, we compute the <strong>marginal probability</strong> of one variable from joint probability over multiple random variables.</p>
<p>Marginalizing is the process of summing over one or more variables (say B) to get the probability of another variable (say A). This summing takes place over the joint probability table.</p>
<div class="math notranslate nohighlight">
\[ P(A) = \sum_{b \in \Omega_B} P(A, B=b) \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_C</span> <span class="o">=</span> <span class="n">joint_probs</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;P(C, D)&#39;</span><span class="p">]</span>
<span class="n">P_C</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;P(C)&#39;</span>
<span class="n">P_D</span> <span class="o">=</span> <span class="n">joint_probs</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;P(C, D)&#39;</span><span class="p">]</span>
<span class="n">P_D</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;P(D)&#39;</span>
<span class="n">P_C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C
H    0.51
T    0.49
Name: P(C), dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_D</span><span class="p">,</span> <span class="n">P_D</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(D
 1    0.43
 2    0.22
 3    0.22
 4    0.05
 5    0.03
 6    0.05
 Name: P(D), dtype: float64,
 1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>5</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>10</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">joint_probs</span><span class="p">[</span><span class="s2">&quot;CD_vals&quot;</span><span class="p">],</span> <span class="n">joint_probs</span><span class="p">[</span><span class="s2">&quot;P(C, D)&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">P_C</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">P_C</span><span class="p">);</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">P_D</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">P_D</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">);</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;P(C, D)&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;P(C)&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;P(D)&quot;</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;P(C) and P(D) (center and right) marginalized from joint probability P(C, D) left&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b839d29de3c2a9fa3affe3f39fda3c71af9e7aedc899788bd7aeb95ff6bca643.png" src="../_images/b839d29de3c2a9fa3affe3f39fda3c71af9e7aedc899788bd7aeb95ff6bca643.png" />
</div>
</div>
<p>As we look at new concepts in probability, it is important to stay mindful of i) what the probability sums to ii) what are the dimensions of the table that represents the probability.</p>
<p>You can see from the cell below that the dimensions of marginal probability table is the length of the range of the variable.</p>
<p>You can see from the code below that both the computed marginal probabilities in add up to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_C</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">P_D</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0, 1.0)
</pre></div>
</div>
</div>
</div>
</section>
<section id="independent-random-variables">
<h2><span class="section-number">4.1.7. </span>Independent Random Variables<a class="headerlink" href="#independent-random-variables" title="Permalink to this headline">#</a></h2>
<p>Random variables can be either independent or dependent. If two random variables are independent, then the value of one random variable does not affect the value of the other random variable.</p>
<p>For example, if we are rolling two dice, we can use two random variables to represent the numbers that we roll. The two random variables are independent because the value of one die does not affect the value of the other die. If two random variables are dependent, then the value of one random variable does affect the value of the other random variable. For example, if we are measuring the temperature and the humidity, we can use two random variables to represent the temperature and the humidity. The two random variables are dependent because the temperature affects the humidity and the humidity affects the temperature.</p>
<p>More formally, <strong>two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are independent if and only if <span class="math notranslate nohighlight">\(P(X, Y) = P(X) \cdot P(Y)\)</span></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_C</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;P(C)&quot;</span>
<span class="n">P_D</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;P(D)&quot;</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">joint_probs</span><span class="p">,</span> <span class="n">P_C</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span>      <span class="n">P_D</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
      <th>P(C)</th>
      <th>P(D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
      <td>0.51</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
      <td>0.49</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
      <td>0.51</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
      <td>0.49</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
      <td>0.51</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>5</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
      <td>0.49</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>6</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>8</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
      <td>0.51</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(C) P(D)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(C)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(D)&#39;</span><span class="p">]</span>
<span class="n">merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
      <th>P(C)</th>
      <th>P(D)</th>
      <th>P(C) P(D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
      <td>0.51</td>
      <td>0.43</td>
      <td>0.2193</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
      <td>0.49</td>
      <td>0.43</td>
      <td>0.2107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
      <td>0.51</td>
      <td>0.22</td>
      <td>0.1122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
      <td>0.49</td>
      <td>0.22</td>
      <td>0.1078</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
      <td>0.51</td>
      <td>0.22</td>
      <td>0.1122</td>
    </tr>
    <tr>
      <th>5</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
      <td>0.49</td>
      <td>0.22</td>
      <td>0.1078</td>
    </tr>
    <tr>
      <th>6</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
      <td>0.0255</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
      <td>0.0245</td>
    </tr>
    <tr>
      <th>8</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
      <td>0.51</td>
      <td>0.03</td>
      <td>0.0153</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.03</td>
      <td>0.0147</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
      <td>0.0255</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
      <td>0.0245</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[[</span><span class="s1">&#39;P(C, D)&#39;</span><span class="p">,</span> <span class="s1">&#39;P(C) P(D)&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>P(C, D)</th>
      <th>P(C) P(D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.24</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.19</td>
      <td>0.21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.13</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.09</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.09</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.13</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.01</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.04</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.03</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.00</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.01</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.04</td>
      <td>0.02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The two random variables <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span> therefore are NOT independent because <span class="math notranslate nohighlight">\(P(C, D) \neq P(C) \cdot P(D)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">merged</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;CD_vals&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P(C, D)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$P(C, D)$&quot;</span><span class="p">);</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">merged</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;CD_vals&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P(C) P(D)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$P(C)\cdot P(D)$&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$C$ and $D$ are NOT independent since $P(C, D) </span><span class="se">\\</span><span class="s2">neq P(C) \cdot P(D)$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f4674492e184d289733e9201485b1de5ba747b5a7f2db0f3d2b0db364a190215.png" src="../_images/f4674492e184d289733e9201485b1de5ba747b5a7f2db0f3d2b0db364a190215.png" />
</div>
</div>
</section>
<section id="conditional-probability-p-a-b">
<h2><span class="section-number">4.1.8. </span>Conditional Probability <span class="math notranslate nohighlight">\(P(A | B)\)</span><a class="headerlink" href="#conditional-probability-p-a-b" title="Permalink to this headline">#</a></h2>
<p>Conditional probability is the probability of one event occurring given that another event has occurred.</p>
<p>The conditional probability is usually denoted by <span class="math notranslate nohighlight">\(P(A | B)\)</span> and is defined as:</p>
<div class="math notranslate nohighlight">
\[ P(A | B) = \frac{P(A, B)}{P(B)} \]</div>
<p>The denominator is the marginal probability of <span class="math notranslate nohighlight">\(B\)</span>.</p>
<a class="reference internal image-reference" href="../_images/conditionalprob.png"><img alt="../_images/conditionalprob.png" class="align-center" src="../_images/conditionalprob.png" style="width: 80%;" /></a>
<br/>
<p>For example, if we are flipping two coins, the conditional probability of flipping heads in the second toss, knowing the first toss was tails is:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p>Possible world</p></th>
<th class="text-center head"><p><span class="math notranslate nohighlight">\(\text{Coin}_1\)</span></p></th>
<th class="text-center head"><p><span class="math notranslate nohighlight">\(\text{Coin}_2\)</span></p></th>
<th class="text-center head"><p><span class="math notranslate nohighlight">\(P(\omega)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_1\)</span></p></td>
<td class="text-center"><p>H</p></td>
<td class="text-center"><p>H</p></td>
<td class="text-center"><p>0.25</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_2\)</span></p></td>
<td class="text-center"><p>H</p></td>
<td class="text-center"><p>T</p></td>
<td class="text-center"><p>0.25</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_3\)</span></p></td>
<td class="text-center"><p>T</p></td>
<td class="text-center"><p>H</p></td>
<td class="text-center"><p>0.25</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\omega_4\)</span></p></td>
<td class="text-center"><p>T</p></td>
<td class="text-center"><p>T</p></td>
<td class="text-center"><p>0.25</p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[ P(\text{Coin}_2 = H | \text{Coin}_1 = T) = \frac{P(\text{Coin}_2 = H, \text{Coin}_1 = T)}{P(\text{Coin}_1 = T)} = \frac{0.25}{0.5} = 0.5 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>P(C, D)</th>
      <th>P(C)</th>
      <th>P(D)</th>
      <th>P(C) P(D)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>0.24</td>
      <td>0.51</td>
      <td>0.43</td>
      <td>0.2193</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T</td>
      <td>1</td>
      <td>0.19</td>
      <td>0.49</td>
      <td>0.43</td>
      <td>0.2107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H</td>
      <td>2</td>
      <td>0.13</td>
      <td>0.51</td>
      <td>0.22</td>
      <td>0.1122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>T</td>
      <td>2</td>
      <td>0.09</td>
      <td>0.49</td>
      <td>0.22</td>
      <td>0.1078</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H</td>
      <td>3</td>
      <td>0.09</td>
      <td>0.51</td>
      <td>0.22</td>
      <td>0.1122</td>
    </tr>
    <tr>
      <th>5</th>
      <td>T</td>
      <td>3</td>
      <td>0.13</td>
      <td>0.49</td>
      <td>0.22</td>
      <td>0.1078</td>
    </tr>
    <tr>
      <th>6</th>
      <td>H</td>
      <td>4</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
      <td>0.0255</td>
    </tr>
    <tr>
      <th>7</th>
      <td>T</td>
      <td>4</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
      <td>0.0245</td>
    </tr>
    <tr>
      <th>8</th>
      <td>H</td>
      <td>5</td>
      <td>0.03</td>
      <td>0.51</td>
      <td>0.03</td>
      <td>0.0153</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T</td>
      <td>5</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.03</td>
      <td>0.0147</td>
    </tr>
    <tr>
      <th>10</th>
      <td>H</td>
      <td>6</td>
      <td>0.01</td>
      <td>0.51</td>
      <td>0.05</td>
      <td>0.0255</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T</td>
      <td>6</td>
      <td>0.04</td>
      <td>0.49</td>
      <td>0.05</td>
      <td>0.0245</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(D | C)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(C, D)&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(C)&#39;</span><span class="p">]</span>
<span class="n">merged</span><span class="p">[</span><span class="s1">&#39;P(D | C)&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.470588
1     0.387755
2     0.254902
3     0.183673
4     0.176471
5     0.265306
6     0.019608
7     0.081633
8     0.058824
9     0.000000
10    0.019608
11    0.081633
Name: P(D | C), dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;P(D | C)&#39;</span><span class="p">]]</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">merged</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P(D | C)&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
<span class="n">axs</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Conditional probability distribution of D given C</span><span class="se">\n</span><span class="s2">Note that the blue bars add up to 1&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1420c5be2e9989958689d6c02f76147b5a4d426884956d67e742f8bfd5986db9.png" src="../_images/1420c5be2e9989958689d6c02f76147b5a4d426884956d67e742f8bfd5986db9.png" />
</div>
</div>
<p>Note that the sum of conditional probabilites, unlike joint probability, is not 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;P(D | C)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<p>This is because</p>
<div class="math notranslate nohighlight">
\[ \sum_C \sum_D P(D|C) = \sum_D P(D|C=\text{Heads}) + \sum_D P(D|C=\text{Tails}) \]</div>
<p>And <span class="math notranslate nohighlight">\(\sum_D P(D|C=\text{Heads})\)</span> and <span class="math notranslate nohighlight">\(\sum_D P(D|C=\text{Tails})\)</span> are individually probability distributions that each sum to 1, over different values of <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>In other words, in the plot above, the blue bars add up to 1 and the orange bars add up to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heads</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">tails</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">]</span>

<span class="n">heads</span><span class="p">[</span><span class="s2">&quot;P(D | C)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">tails</span><span class="p">[</span><span class="s2">&quot;P(D | C)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0, 1.0)
</pre></div>
</div>
</div>
</div>
</section>
<section id="product-rule-p-a-b">
<h2><span class="section-number">4.1.9. </span>Product Rule <span class="math notranslate nohighlight">\(P(A, B)\)</span><a class="headerlink" href="#product-rule-p-a-b" title="Permalink to this headline">#</a></h2>
<p>Rearranging the definition of conditional probability, we get the product rule:</p>
<div class="math notranslate nohighlight">
\[ P(A, B) = P(A | B) \cdot P(B) \]</div>
<p>Similarly, we can also write:</p>
<div class="math notranslate nohighlight">
\[ P(A, B) = P(B | A) \cdot P(A)\]</div>
<p>In summary,</p>
<div class="math notranslate nohighlight">
\[ P(A, B) = P(A | B) \cdot P(B) = P(B | A) \cdot P(A)\]</div>
</section>
<section id="chain-rule-p-a-b-c">
<h2><span class="section-number">4.1.10. </span>Chain Rule <span class="math notranslate nohighlight">\(P(A, B, C)\)</span><a class="headerlink" href="#chain-rule-p-a-b-c" title="Permalink to this headline">#</a></h2>
<p>The chain rule is a generalization of the product rule to more than two events.</p>
<p><span class="math notranslate nohighlight">\( P(A, B, C) = P(A | B, C) \cdot P(B, C) \)</span></p>
<p><span class="math notranslate nohighlight">\(P(A, B, C) = P(A | B, C) \cdot P(B | C) \cdot P(C)\)</span></p>
<p>since <span class="math notranslate nohighlight">\(P(B, C) = P(B | C) \cdot P(C)\)</span> as per the product rule.</p>
<p><strong>Chain rule essentially allows expressing the joint probability of multiple random variables as a product of conditional probabilities.</strong> This is useful because conditional probabilities are often easier to estimate from data than joint probabilities.</p>
</section>
<section id="inclusion-exclusion-principle-p-a-vee-b">
<h2><span class="section-number">4.1.11. </span>Inclusion-Exclusion Principle <span class="math notranslate nohighlight">\(P(A \vee B)\)</span><a class="headerlink" href="#inclusion-exclusion-principle-p-a-vee-b" title="Permalink to this headline">#</a></h2>
<p>Inclusion-Exclusion Principle is a way of calculating the probability of two events occurring i.e. <span class="math notranslate nohighlight">\( P(A=a ~\text{OR}~ B=b) \)</span> denoted generally as <span class="math notranslate nohighlight">\(P(A = a \vee B = b)\)</span>.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[ P(A = a \vee B = b) = P(A = a) + P(B = b) - P(A = a \wedge B = b) \]</div>
<a class="reference internal image-reference" href="../_images/inclusion_exclusion.png"><img alt="../_images/inclusion_exclusion.png" class="align-center" src="../_images/inclusion_exclusion.png" style="width: 80%;" /></a>
<p>For example, if we are rolling two dice, the Inclusion-Exclusion Principle can be used to calculate the probability of rolling a 1 on the first die or a 2 on the second die.</p>
<p><span class="math notranslate nohighlight">\(P(\text{Coin}_1=H \vee \text{Coin}_2=T) \)</span></p>
<p><span class="math notranslate nohighlight">\( = P(\text{Coin}_2=H) + P(\text{Coin}_1=T) - P(\text{Coin}_2=H ∧ \text{Coin}_1=T)\)</span></p>
<p><span class="math notranslate nohighlight">\( = 0.5 + 0.5 - 0.25 \)</span></p>
<p><span class="math notranslate nohighlight">\( = 0.75\)</span></p>
</section>
<section id="bayes-theorem-p-a-b">
<h2><span class="section-number">4.1.12. </span>Bayes Theorem <span class="math notranslate nohighlight">\(P(A|B)\)</span><a class="headerlink" href="#bayes-theorem-p-a-b" title="Permalink to this headline">#</a></h2>
<p>Bayes theorem is a way of calculating conditional probability. For example, if we are rolling two dice, Bayes theorem can be used to calculate the probability of rolling a 1 on the first die given that we rolled a 2 on the second die.</p>
<div class="math notranslate nohighlight">
\[ P(A | B) = \frac{P(B | A) \cdot P(A)}{P(B)} \]</div>
<p><span class="math notranslate nohighlight">\(P(A|B)\)</span> in the context of Bayes theorem is called the <strong>Posterior</strong> probability.</p>
<p><span class="math notranslate nohighlight">\(P(B|A)\)</span> is called the <strong>Likelihood</strong>.</p>
<p><span class="math notranslate nohighlight">\(P(A)\)</span> is called the <strong>Prior</strong> probability.</p>
<p><span class="math notranslate nohighlight">\(P(B)\)</span> is called the <strong>Evidence</strong>, also known as <em>Marginal Likelihood</em>.</p>
<div class="math notranslate nohighlight">
\[ P(\text{Posterior}) = \frac{P(\text{Likelihood})\cdot P(\text{Prior})}{P(\text{Evidence})}\]</div>
<center><img width="40%" src="https://www.analyticsvidhya.com/wp-content/uploads/2016/06/12.jpg"></center><!-- 
## Expectation

Expectation is the average value of a random variable. For example, if we are rolling a die, the expectation is the average value of the number that we roll. The expectation is usually denoted by $E(X)$.

$$ E(X) = \sum_{x \in X} x \cdot P(X=x) $$

## Variance

Variance is a measure of how spread out a random variable is. For example, if we are rolling a die, the variance is a measure of how spread out the numbers that we roll are. The variance is usually denoted by $Var(X)$.

$$ Var(X) = E((X - E(X))^2) = E(X^2) - E(X)^2 $$

## Covariance

Covariance is a measure of how two random variables vary together. For example, if we are rolling two dice, the covariance is a measure of how the numbers that we roll on the two dice vary together. The covariance is usually denoted by $Cov(X, Y)$.

$$ Cov(X, Y) = E((X - E(X)) \cdot (Y - E(Y))) = E(X \cdot Y) - E(X) \cdot E(Y) $$

## Correlation

Correlation is a measure of how two random variables vary together. For example, if we are rolling two dice, the correlation is a measure of how the numbers that we roll on the two dice vary together. The correlation is usually denoted by $Corr(X, Y)$.

$$ Corr(X, Y) = \frac{Cov(X, Y)}{\sqrt{Var(X) \cdot Var(Y)}} $$ --><p>Bayes Theorem allows a formal method of updating prior beliefs with new evidence and is the foundation of Bayesian Statistics. We will talk more about this when we talk about Statistics.</p>
<p>In machine learning, the task is often to find <span class="math notranslate nohighlight">\(P(Y | X_1 = x_1, X_2 = x_2, \ldots X_D = x_D)\)</span> i.e. the probability of an unknown Y, given some values for <span class="math notranslate nohighlight">\(D\)</span> features (<span class="math notranslate nohighlight">\(X_1, X_2 \ldots X_D\)</span>). Bayes theorem allows us to calculate this probability from the data.</p>
<p>Let’s assume we are interested in predicting if a person is a football player (<span class="math notranslate nohighlight">\(Y_F=1\)</span>) or not (<span class="math notranslate nohighlight">\(Y_F=0\)</span>), given their height (<span class="math notranslate nohighlight">\(X_H\)</span>) and weight (<span class="math notranslate nohighlight">\(X_W\)</span>).</p>
<p>Say, we observe a person who is 7 feet tall and weighs 200 pounds. We can use Bayes theorem to calculate the probability of this person being a football player using the following equation:</p>
<p><span class="math notranslate nohighlight">\(P(Y | X_H = 7, X_W = 200) = \frac{P(X_H = 7, X_W = 200 | Y_F) \cdot P(Y_F)}{P(X_H = 7, X_W = 200)}\)</span></p>
<p>Note that here <span class="math notranslate nohighlight">\(P(X_H = 7, X_W = 200 | Y_F)\)</span> is the <strong>Likelihood</strong> probability of observing someone who is 7 feet tall and weighs 200 pounds, knowing if they are a football player.</p>
<p><span class="math notranslate nohighlight">\(P(Y_F)\)</span> is the <strong>Prior</strong> probability of a person being a football player out of the entire population.</p>
<p><span class="math notranslate nohighlight">\(P(X_H = 7, X_W = 200)\)</span> is the probability of the <strong>Evidence</strong> i.e. probability  of observing <em>anyone</em> who is 7 feet tall and weighs 200 pounds in the entire population.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./2_maths"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="10_prob_stats_log.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Prob, Stats and Logs</p>
      </div>
    </a>
    <a class="right-next"
       href="12_stats.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.2. </span>Statistics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-variable">4.1.1. Random Variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-outcome-omega-and-sample-space-omega">4.1.2. Experiment, Outcome <span class="math notranslate nohighlight">\(\omega\)</span> and Sample Space <span class="math notranslate nohighlight">\(\Omega\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-model-p-x">4.1.3. Probability Model <span class="math notranslate nohighlight">\(P(X)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-an-event-p-phi">4.1.4. Probability of an Event <span class="math notranslate nohighlight">\(P(\phi)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-probability-p-a-b">4.1.5. Joint Probability <span class="math notranslate nohighlight">\(P(A, B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#marginal-probability-p-a">4.1.6. Marginal Probability <span class="math notranslate nohighlight">\(P(A)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-random-variables">4.1.7. Independent Random Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conditional-probability-p-a-b">4.1.8. Conditional Probability <span class="math notranslate nohighlight">\(P(A | B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#product-rule-p-a-b">4.1.9. Product Rule <span class="math notranslate nohighlight">\(P(A, B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chain-rule-p-a-b-c">4.1.10. Chain Rule <span class="math notranslate nohighlight">\(P(A, B, C)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusion-exclusion-principle-p-a-vee-b">4.1.11. Inclusion-Exclusion Principle <span class="math notranslate nohighlight">\(P(A \vee B)\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-theorem-p-a-b">4.1.12. Bayes Theorem <span class="math notranslate nohighlight">\(P(A|B)\)</span></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Syed Fahad Sultan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>